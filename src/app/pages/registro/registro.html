<main class="container dashboard-container">

  <div class="register-layout" style="display: flex; justify-content: center; align-items: flex-start; min-height: calc(100vh - 200px); padding: 2rem 0;">
    <section class="dashboard-content" style="width: 100%; max-width: 800px; margin: 0;">
      <div class="content-header" style="text-align: center; margin-bottom: 3rem;">
        <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">Únete a ViviGo</h1>
        <p style="font-size: 1.2rem; color: #7F8C8D;">Crea tu cuenta y comienza tu aventura</p>
      </div>

      <div class="form-container">
        <form [formGroup]="registroForm" (ngSubmit)="crearUsuario()" novalidate="">
          <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 2rem; max-width: 700px; margin: 0 auto;">
            <div class="form-group">
              <label for="nombre">Nombre *</label>
              <input type="text" id="nombre" name="nombre" required placeholder="Tu nombre" formControlName="nombre" [class.error]="registroForm.get('nombre')?.invalid && registroForm.get('nombre')?.touched">
              @if (registroForm.get('nombre')?.invalid && registroForm.get('nombre')?.touched) {
                <div class="error-message show">Este campo es obligatorio</div>
              }
            </div>

            <div class="form-group">
              <label for="apellido">Apellido *</label>
              <input type="text" id="apellido" name="apellido" required placeholder="Tu apellido" formControlName="apellido" [class.error]="registroForm.get('apellido')?.invalid && registroForm.get('apellido')?.touched">
              @if (registroForm.get('apellido')?.invalid && registroForm.get('apellido')?.touched) {
                <div class="error-message show">Este campo es obligatorio</div>
              }
            </div>

            <div class="form-group full-width">
              <label for="email">Correo Electrónico *</label>
              <input type="email" id="email" name="email" required placeholder="tu@email.com" formControlName="email" [class.error]="registroForm.get('email')?.invalid && registroForm.get('email')?.touched">
              @if (registroForm.get('email')?.hasError('email') && registroForm.get('email')?.touched || registroForm.get('email')?.invalid && registroForm.get('email')?.touched) {
                <div class="error-message show">Por favor ingresa un email válido</div>
              }
            </div>

            <div class="form-group full-width">
              <label for="contrasena">Contraseña *</label>
              <input type="password" id="contrasena" name="contrasena" required placeholder="Mínimo 8 caracteres" formControlName="contrasena" [class.error]="registroForm.get('contrasena')?.invalid && registroForm.get('contrasena')?.touched">
              <div class="password-requirements">
                <p><i class="fa-solid fa-info-circle"></i> Debe contener al menos:</p>
                <ul>
                  <li id="tamano">8 caracteres</li>
                  <li id="mayuscula">1 letra mayúscula</li>
                  <li id="numero">1 número</li>
                </ul>
              </div>
              @if (registroForm.get('contrasena')?.hasError('contrasenaSegura') && registroForm.get('contrasena')?.touched) {
                <div class="error-message show">Debe contener al menos una mayúscula y un número</div>
              }
              @if (registroForm.get('contrasena')?.hasError('minlength') && registroForm.get('contrasena')?.touched) {
                <div class="error-message show">Debe tener mínimo 8 caracteres</div>
              }
              @if (registroForm.get('contrasena')?.invalid && registroForm.get('contrasena')?.touched) {
                <div class="error-message show">Ingrese una contrasena</div>
              }
            </div>

            <div class="form-group full-width">
              <label for="confirmarContrasena">Confirmar Contraseña *</label>
              <input type="password" id="confirmarContrasena" name="confirmarContrasena" required placeholder="Repite tu contraseña" formControlName="confirmarContrasena" [class.error]="registroForm.hasError('contrasenasNoCoinciden') && registroForm.get('confirmarContrasena')?.touched">
              @if (registroForm.hasError('contrasenasNoCoinciden') && registroForm.get('confirmarContrasena')?.touched) {
                <div class="error-message show">Las contraseñas no coinciden</div>
              }
            </div>

            <div class="form-group">
              <label for="telefono">Teléfono *</label>
              <input type="tel" id="telefono" name="telefono" required placeholder="300 123 4567" formControlName="telefono" [class.error]="registroForm.get('telefono')?.invalid && registroForm.get('telefono')?.touched">
              @if (registroForm.get('telefono')?.hasError('pattern') && registroForm.get('telefono')?.touched || registroForm.get('telefono')?.invalid && registroForm.get('telefono')?.touched) {
                <div class="error-message show">Por favor ingresa un teléfono válido</div>
              }
            </div>

            <div class="form-group">
              <label for="fechaNacimiento">Fecha de Nacimiento *</label>
              <input type="date" id="fechaNacimiento" name="fechaNacimiento" required formControlName="fechaNacimiento" [class.error]="registroForm.get('fechaNacimiento')?.invalid && registroForm.get('fechaNacimiento')?.touched">
              @if (registroForm.get('fechaNacimiento')?.hasError('edadMinima') && registroForm.get('fechaNacimiento')?.touched) {
                <div class="error-message show">Debes ser mayor de 18 años</div>
              }
            </div>
            <div class="form-group full-width" style="display: block !important; flex-direction: initial !important;">
              <div style="display: table; width: 100%;">
                <div style="display: table-cell; width: 20px; vertical-align: top; padding-top: 3px;">
                  <input type="checkbox" id="terminos" name="terminos" required style="margin: 0; padding: 0;" formControlName="terminos">
                </div>
                <div style="display: table-cell; vertical-align: top; padding-left: 8px;">
                  <label for="terminos" style="font-weight: 400; line-height: 1.5; cursor: pointer; margin: 0; display: block;">
                    Acepto los <a href="#" style="color: var(--primary-color); font-weight: 600;">Términos y Condiciones</a> y la <a href="#" style="color: var(--primary-color); font-weight: 600;">Política de Privacidad</a> de ViviGo *
                  </label>
                </div>
              </div>
              @if (registroForm.get('terminos')?.invalid && registroForm.get('terminos')?.touched) {
                <div class="error-message show">Debes aceptar los términos y condiciones</div>
              }
            </div>

          </div>
          <div class="form-navigation" style="justify-content: center; border-top: none; padding-top: 2rem; max-width: 700px; margin: 0 auto;">
            <button type="submit" [disabled]="registroForm.invalid" class="btn btn-primary" style="width: 300px; padding: 16px 24px; font-size: 1.1rem;" >
              <i class="fa-solid fa-user-plus"></i>
              Crear mi cuenta
            </button>
          </div>
        </form>

        <div style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--light-green); max-width: 700px; margin-left: auto; margin-right: auto;">
          <p style="font-size: 1.1rem;">¿Ya tienes una cuenta? <li><a href="/login" style="color: var(--primary-color); font-weight: 600;">Inicia Sesión</a></li></p>
        </div>
      </div>

    </section>
  </div>
</main>
